FROM ubuntu:22.04

RUN apt update && apt upgrade -y
RUN apt install -y wget make git

# install postgres
RUN git clone https://github.com/postgrespro/postgres
RUN cd postgres
RUN ./configure
RUN make
RUN su
RUN make install
RUN adduser postgres
RUN mkdir -p /usr/local/pgsql/data
RUN su - postgres
RUN /usr/local/pgsql/bin/initdb -D /usr/local/pgsql/data
RUN /usr/local/pgsql/bin/pg_ctl -D /usr/local/pgsql/data -l logfile start
RUN /usr/local/pgsql/bin/createdb main_db
RUN /usr/local/pgsql/bin/psql main_db